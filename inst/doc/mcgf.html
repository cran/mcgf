<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>mcgf</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">mcgf</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>mcgf</code> package contains useful functions to simulate
Markov chain Gaussian fields (MCGF) and regime-switching Markov chain
Gaussian fields (RS-MCGF) with covariance structures of the Gneiting
class <span class="citation">(Gneiting 2002)</span>. It also provides
useful tools to estimate the parameters by weighted least squares (WLS)
and maximum likelihood estimation (MLE). The <code>mcgf</code> can used
to fit covariance models and obtain Kriging forecasts. A typical
workflow is given below.</p>
<ol style="list-style-type: decimal">
<li>Create an <code>mcgf</code> object by providing a dataset and the
corresponding locations/distances</li>
<li>Calculate auto- and cross- correlations.</li>
<li>Fit the base covariance model which is a fully symmetric model.</li>
<li>Fit the Lagrangian model to account for asymmetry, if
necessary.</li>
<li>Obtain Kriging forecasts.</li>
</ol>
<p>We will demonstrate the use of <code>mcgf</code> by an example
below.</p>
</div>
<div id="irish-wind" class="section level1">
<h1>Irish Wind</h1>
<p>The Ireland wind data contains daily wind speeds for 1961-1978 at 11
synoptic meteorological stations in the Republic of Ireland. It is
available in the <code>gstat</code> package and is also imported to
<code>mcgf</code>. To view the details on this dataset, run
<code>help(wind)</code>. The object <code>wind</code> contains the wind
speeds data as well as the locations of the stations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(mcgf)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(wind)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">head</span>(wind<span class="sc">$</span>data)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt;         time      VAL      BEL       CLA      SHA      ROC      BIR      MUL</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; 1 1961-01-01 7.696089 9.517222 5.2730556 7.181644 7.737244 5.077567 5.571433</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; 2 1961-01-02 8.683822 9.023356 5.1650222 6.492289 7.567478 3.945789 5.036411</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; 3 1961-01-03 8.683822 6.559167 4.1361333 5.746344 9.517222 3.174122 4.372778</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; 4 1961-01-04 3.410767 2.808867 0.9208556 2.335578 5.442822 1.481600 2.999211</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; 5 1961-01-05 6.816389 6.646622 3.3644667 5.509700 6.857544 4.223589 5.617733</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; 6 1961-01-06 4.177289 4.177289 2.2738444 2.762567 6.795811 2.315000 3.688567</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt;        MAL      KIL      CLO      DUB</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; 1 7.737244 4.779189 6.471711 7.032456</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; 2 7.114767 3.343889 4.974678 5.916111</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; 3 6.538589 5.211322 3.945789 5.787500</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; 4 5.597156 2.356156 3.024933 4.439656</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; 5 6.085878 3.174122 5.319356 6.132178</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; 6 6.775233 3.431344 3.858333 5.489122</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="fu">head</span>(wind<span class="sc">$</span>locations)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt;            lon      lat</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; VAL -10.250000 51.93333</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt; BEL -10.000000 54.23333</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt; CLA  -8.983333 53.71667</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt; SHA  -8.916667 52.70000</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt; ROC  -8.250000 51.80000</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co">#&gt; BIR  -7.883333 53.08333</span></span></code></pre></div>
<div id="data-de-treding" class="section level2">
<h2>Data De-treding</h2>
<p>To fit covariance models on <code>wind</code>, the first step is to
load the data set and de-trend the data to have a mean-zero time series.
We will follow the data de-trending procedure in <span class="citation">Gneiting, Genton, and Guttorp (2006)</span>.</p>
<ol style="list-style-type: decimal">
<li>We start with removing the leap day and take the square-root
transformation. To do this we need to use the <code>lubridate</code>
package.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># install.packages(&quot;lubridate&quot;)</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>ind_leap <span class="ot">&lt;-</span> <span class="fu">month</span>(wind<span class="sc">$</span>data<span class="sc">$</span>time) <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="fu">day</span>(wind<span class="sc">$</span>data<span class="sc">$</span>time) <span class="sc">==</span> <span class="dv">29</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>wind_de <span class="ot">&lt;-</span> wind<span class="sc">$</span>data[<span class="sc">!</span>ind_leap, ]</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>wind_de[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(wind_de[, <span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Next, we split the data into training and test datasets, where
training contains data in 1961-1970 and test spans 1971-1978.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>is_train <span class="ot">&lt;-</span> <span class="fu">year</span>(wind_de<span class="sc">$</span>time) <span class="sc">&lt;=</span> <span class="dv">1970</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>wind_train <span class="ot">&lt;-</span> wind_de[is_train, ]</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>wind_test <span class="ot">&lt;-</span> wind_de[<span class="sc">!</span>is_train, ]</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>We will estimate and remove the annual trend for the training
dataset. The annual trend is the daily averages across the training
years. We will use the <code>dplyr</code> package for this task.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># install.packages(&quot;dplyr&quot;)</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># Estimate annual trend</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>avg_train <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(wind_train<span class="sc">$</span>time),</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">day</span>(wind_train<span class="sc">$</span>time),</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="at">ws =</span> <span class="fu">rowMeans</span>(wind_train[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>trend_train <span class="ot">&lt;-</span> avg_train <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    <span class="fu">group_by</span>(month, day) <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">trend =</span> <span class="fu">mean</span>(ws))</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co"># Subtract annual trend</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>trend_train2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(avg_train, trend_train, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>))<span class="sc">$</span>trend</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>wind_train[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> wind_train[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> trend_train2</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>To obtain a mean-zero time series, we will subtract the station-wise
mean for each station.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Subtract station-wise mean</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>mean_train <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(wind_train[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>wind_train[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sweep</span>(wind_train[, <span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, mean_train)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>wind_trend <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">annual =</span> <span class="fu">as.data.frame</span>(trend_train),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">mean =</span> mean_train</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Finally, we will subtract the annual trend and station-wise mean
from the test dataset.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>avg_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(wind_test<span class="sc">$</span>time),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">day</span>(wind_test<span class="sc">$</span>time)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>trend_train3 <span class="ot">&lt;-</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="fu">left_join</span>(avg_test, trend_train, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>))<span class="sc">$</span>trend</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> trend_train3</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sweep</span>(wind_test[, <span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, mean_train)</span></code></pre></div>
</div>
<div id="fitting-covariance-models" class="section level2">
<h2>Fitting Covariance Models</h2>
<p>We will first fit pure spatial and temporal models, then the fully
symmetric model, and finally the general stationary model. First, we
will create an <code>mcgf</code> object and calculate auto- and cross-
correlations.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>wind_mcgf <span class="ot">&lt;-</span> <span class="fu">mcgf</span>(wind_train[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">locations =</span> wind<span class="sc">$</span>locations)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; `time` is not provided, assuming rows are equally spaced temporally.</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>wind_mcgf <span class="ot">&lt;-</span> <span class="fu">add_acfs</span>(wind_mcgf, <span class="at">lag_max =</span> <span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>wind_mcgf <span class="ot">&lt;-</span> <span class="fu">add_ccfs</span>(wind_mcgf, <span class="at">lag_max =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Here <code>acfs</code> actually refers to the mean auto-correlations
across the stations for each time lag. To view the calculated
<code>acfs</code>, we can run:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">acfs</span>(wind_mcgf)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;      lag0      lag1      lag2      lag3 </span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; 1.0000000 0.5072739 0.2382621 0.1643998</span></span></code></pre></div>
<p>Similarly, we can view the <code>ccfs</code> by:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ccfs</span>(wind_mcgf)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; , , lag0</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;           VAL       BEL       CLA       SHA       ROC       BIR       MUL</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; VAL 1.0000000 0.7076428 0.7588797 0.8299603 0.7962082 0.7719814 0.6688609</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; BEL 0.7076428 1.0000000 0.8471918 0.7432194 0.5795413 0.7650007 0.7371354</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; CLA 0.7588797 0.8471918 1.0000000 0.8520358 0.6994680 0.8777462 0.8410719</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; SHA 0.8299603 0.7432194 0.8520358 1.0000000 0.7960579 0.8865147 0.8239009</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; ROC 0.7962082 0.5795413 0.6994680 0.7960579 1.0000000 0.7592625 0.7305102</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; BIR 0.7719814 0.7650007 0.8777462 0.8865147 0.7592625 1.0000000 0.8841425</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; MUL 0.6688609 0.7371354 0.8410719 0.8239009 0.7305102 0.8841425 1.0000000</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; MAL 0.5153690 0.7087588 0.6818106 0.6121929 0.5357199 0.6411302 0.7375539</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; KIL 0.7333467 0.6487696 0.7772730 0.8236153 0.8338255 0.8406781 0.8414494</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; CLO 0.6718720 0.7697673 0.8511102 0.7759129 0.6876764 0.8436560 0.8699373</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; DUB 0.5967529 0.6498491 0.7420593 0.7361857 0.6862624 0.7812147 0.8609285</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt;           MAL       KIL       CLO       DUB</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; VAL 0.5153690 0.7333467 0.6718720 0.5967529</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; BEL 0.7087588 0.6487696 0.7697673 0.6498491</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; CLA 0.6818106 0.7772730 0.8511102 0.7420593</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; SHA 0.6121929 0.8236153 0.7759129 0.7361857</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; ROC 0.5357199 0.8338255 0.6876764 0.6862624</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; BIR 0.6411302 0.8406781 0.8436560 0.7812147</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; MUL 0.7375539 0.8414494 0.8699373 0.8609285</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; MAL 1.0000000 0.5892218 0.7568132 0.7145366</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; KIL 0.5892218 1.0000000 0.7934818 0.7770512</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; CLO 0.7568132 0.7934818 1.0000000 0.8161496</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; DUB 0.7145366 0.7770512 0.8161496 1.0000000</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; , , lag1</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt;           VAL       BEL       CLA       SHA       ROC       BIR       MUL</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; VAL 0.4739681 0.4078097 0.3734029 0.4028977 0.3406302 0.3871317 0.3171416</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; BEL 0.3843919 0.5310138 0.4208376 0.3899411 0.2819817 0.4000168 0.3695143</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; CLA 0.4164508 0.4814516 0.4993218 0.4450647 0.3244728 0.4521809 0.4020938</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; SHA 0.4719522 0.4646048 0.4689832 0.5137855 0.3883962 0.4677375 0.4100365</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; ROC 0.4706594 0.3793417 0.3852120 0.4285917 0.4442973 0.4113073 0.3590478</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; BIR 0.4725125 0.4964189 0.4986726 0.4927316 0.3919890 0.5409202 0.4557624</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; MUL 0.4438395 0.5082231 0.5039360 0.4898975 0.4056061 0.5097809 0.5228395</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; MAL 0.3550724 0.4616666 0.4118390 0.3918386 0.3360198 0.3792364 0.4182625</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; KIL 0.4867586 0.4607927 0.4866086 0.4964729 0.4299541 0.4930438 0.4430179</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; CLO 0.4390459 0.5117641 0.5057839 0.4686427 0.3853159 0.4904330 0.4549374</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; DUB 0.4333070 0.4698080 0.4829445 0.4819004 0.4349093 0.4860929 0.4858079</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt;           MAL       KIL       CLO       DUB</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; VAL 0.2712570 0.2917876 0.3248601 0.2900024</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt; BEL 0.3554572 0.3012227 0.3806926 0.3179568</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt; CLA 0.3289562 0.3458138 0.4112028 0.3569920</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt; SHA 0.3203410 0.3834180 0.4088611 0.3736715</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; ROC 0.2950458 0.3540329 0.3479210 0.3484134</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; BIR 0.3408605 0.3973215 0.4505508 0.3984836</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; MUL 0.4151149 0.4232129 0.4664284 0.4434980</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt; MAL 0.5296408 0.3105146 0.4036000 0.4002747</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt; KIL 0.3227371 0.4642266 0.4387080 0.3981810</span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; CLO 0.4032414 0.4076724 0.5190745 0.4289406</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; DUB 0.4428008 0.4300411 0.4765407 0.5409250</span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co">#&gt; , , lag2</span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt;           VAL       BEL       CLA       SHA       ROC       BIR       MUL</span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a><span class="co">#&gt; VAL 0.2011319 0.1973159 0.1630851 0.1871285 0.1489858 0.1943355 0.1492425</span></span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a><span class="co">#&gt; BEL 0.1713197 0.2588323 0.1891480 0.1936055 0.1240906 0.2020276 0.1806373</span></span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a><span class="co">#&gt; CLA 0.1585236 0.2132206 0.2247423 0.2000905 0.1184259 0.2115274 0.1763905</span></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="co">#&gt; SHA 0.1938118 0.2298367 0.2157028 0.2391773 0.1589136 0.2265611 0.1844087</span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a><span class="co">#&gt; ROC 0.1765714 0.1716184 0.1421018 0.1764547 0.1696931 0.1742268 0.1451217</span></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a><span class="co">#&gt; BIR 0.2020194 0.2401048 0.2278565 0.2262318 0.1628422 0.2765692 0.2136481</span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a><span class="co">#&gt; MUL 0.1862142 0.2487854 0.2182151 0.2159567 0.1694341 0.2448788 0.2510983</span></span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a><span class="co">#&gt; MAL 0.1555252 0.2110852 0.1623937 0.1691266 0.1462008 0.1585537 0.1853651</span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a><span class="co">#&gt; KIL 0.1743715 0.2068322 0.1970328 0.2091868 0.1495429 0.2192173 0.1882474</span></span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a><span class="co">#&gt; CLO 0.1835787 0.2349159 0.2190671 0.2138391 0.1511675 0.2355708 0.2042911</span></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a><span class="co">#&gt; DUB 0.1856084 0.2176080 0.2022041 0.2148639 0.1950841 0.2234817 0.2150465</span></span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a><span class="co">#&gt;           MAL       KIL       CLO       DUB</span></span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a><span class="co">#&gt; VAL 0.1427551 0.1382869 0.1666310 0.1535865</span></span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a><span class="co">#&gt; BEL 0.1754907 0.1388237 0.1941650 0.1629718</span></span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a><span class="co">#&gt; CLA 0.1419690 0.1537041 0.1979937 0.1674888</span></span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a><span class="co">#&gt; SHA 0.1503395 0.1803397 0.2022438 0.1764521</span></span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a><span class="co">#&gt; ROC 0.1458883 0.1373046 0.1488279 0.1654739</span></span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a><span class="co">#&gt; BIR 0.1438303 0.1844782 0.2197392 0.1920556</span></span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a><span class="co">#&gt; MUL 0.1950942 0.1905402 0.2183714 0.2084112</span></span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a><span class="co">#&gt; MAL 0.2636079 0.1107242 0.1729375 0.1921164</span></span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a><span class="co">#&gt; KIL 0.1334084 0.1931797 0.1982144 0.1790683</span></span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a><span class="co">#&gt; CLO 0.1715671 0.1793731 0.2624348 0.2135477</span></span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a><span class="co">#&gt; DUB 0.2180694 0.1899728 0.2270066 0.2804169</span></span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a><span class="co">#&gt; , , lag3</span></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a><span class="co">#&gt;            VAL       BEL        CLA        SHA        ROC        BIR        MUL</span></span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a><span class="co">#&gt; VAL 0.15186704 0.1424697 0.12263507 0.12486035 0.11217575 0.14386635 0.09991865</span></span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a><span class="co">#&gt; BEL 0.12223738 0.1854410 0.13490665 0.13169403 0.08728794 0.14207057 0.12397596</span></span>
<span id="cb9-88"><a href="#cb9-88" tabindex="-1"></a><span class="co">#&gt; CLA 0.10549441 0.1408343 0.16084299 0.13066846 0.07914442 0.13859706 0.10865229</span></span>
<span id="cb9-89"><a href="#cb9-89" tabindex="-1"></a><span class="co">#&gt; SHA 0.12004043 0.1511578 0.14232764 0.14961877 0.09888111 0.14670946 0.11247087</span></span>
<span id="cb9-90"><a href="#cb9-90" tabindex="-1"></a><span class="co">#&gt; ROC 0.11051322 0.1022188 0.08007433 0.09282562 0.10856180 0.10063755 0.07957425</span></span>
<span id="cb9-91"><a href="#cb9-91" tabindex="-1"></a><span class="co">#&gt; BIR 0.13309457 0.1594322 0.15267585 0.13773090 0.10595023 0.19194636 0.13771463</span></span>
<span id="cb9-92"><a href="#cb9-92" tabindex="-1"></a><span class="co">#&gt; MUL 0.11364183 0.1682815 0.14195183 0.12747872 0.10407473 0.15372629 0.16630054</span></span>
<span id="cb9-93"><a href="#cb9-93" tabindex="-1"></a><span class="co">#&gt; MAL 0.09065312 0.1431289 0.10244646 0.10197080 0.09770836 0.08625211 0.11386343</span></span>
<span id="cb9-94"><a href="#cb9-94" tabindex="-1"></a><span class="co">#&gt; KIL 0.09511038 0.1179299 0.11535092 0.11479319 0.07924395 0.12369722 0.10034132</span></span>
<span id="cb9-95"><a href="#cb9-95" tabindex="-1"></a><span class="co">#&gt; CLO 0.12004487 0.1584521 0.15581710 0.13825387 0.10650927 0.15601087 0.13152273</span></span>
<span id="cb9-96"><a href="#cb9-96" tabindex="-1"></a><span class="co">#&gt; DUB 0.10526163 0.1331954 0.11965370 0.11622550 0.11602725 0.12380225 0.11590933</span></span>
<span id="cb9-97"><a href="#cb9-97" tabindex="-1"></a><span class="co">#&gt;            MAL        KIL        CLO       DUB</span></span>
<span id="cb9-98"><a href="#cb9-98" tabindex="-1"></a><span class="co">#&gt; VAL 0.11038186 0.09840820 0.12881956 0.1131093</span></span>
<span id="cb9-99"><a href="#cb9-99" tabindex="-1"></a><span class="co">#&gt; BEL 0.11895940 0.09539470 0.13930407 0.1065024</span></span>
<span id="cb9-100"><a href="#cb9-100" tabindex="-1"></a><span class="co">#&gt; CLA 0.08566429 0.10250903 0.13807158 0.1059626</span></span>
<span id="cb9-101"><a href="#cb9-101" tabindex="-1"></a><span class="co">#&gt; SHA 0.10015324 0.11889068 0.14364630 0.1110210</span></span>
<span id="cb9-102"><a href="#cb9-102" tabindex="-1"></a><span class="co">#&gt; ROC 0.10700118 0.08017778 0.09975703 0.1043980</span></span>
<span id="cb9-103"><a href="#cb9-103" tabindex="-1"></a><span class="co">#&gt; BIR 0.09283539 0.12122167 0.15906405 0.1304590</span></span>
<span id="cb9-104"><a href="#cb9-104" tabindex="-1"></a><span class="co">#&gt; MUL 0.13033344 0.11347989 0.14872192 0.1286318</span></span>
<span id="cb9-105"><a href="#cb9-105" tabindex="-1"></a><span class="co">#&gt; MAL 0.19778972 0.05899522 0.10990283 0.1253038</span></span>
<span id="cb9-106"><a href="#cb9-106" tabindex="-1"></a><span class="co">#&gt; KIL 0.07627083 0.11333371 0.12609113 0.1024267</span></span>
<span id="cb9-107"><a href="#cb9-107" tabindex="-1"></a><span class="co">#&gt; CLO 0.10926382 0.12014806 0.20136056 0.1459052</span></span>
<span id="cb9-108"><a href="#cb9-108" tabindex="-1"></a><span class="co">#&gt; DUB 0.14141118 0.10085759 0.14688397 0.1813353</span></span></code></pre></div>
<div id="pure-spatial-model" class="section level3">
<h3>Pure Spatial Model</h3>
<p>The pure spatial model can be fitted using the <code>fit_base</code>
function. The results are actually obtained from the optimization
function <code>nlminb</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>fit_spatial <span class="ot">&lt;-</span> <span class="fu">fit_base</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    wind_mcgf,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;spatial&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="at">lag =</span> <span class="dv">3</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">par_init =</span> <span class="fu">c</span>(<span class="at">nugget =</span> <span class="fl">0.1</span>, <span class="at">c =</span> <span class="fl">0.001</span>),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="at">par_fixed =</span> <span class="fu">c</span>(<span class="at">gamma =</span> <span class="fl">0.5</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>fit_spatial<span class="sc">$</span>fit</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; $par</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt;           c      nugget </span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; 0.001326223 0.049124593 </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; $objective</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; [1] 1.742004</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; $convergence</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt; $iterations</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt; $evaluations</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt; function gradient </span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt;       23       24 </span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt; $message</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;relative convergence (4)&quot;</span></span></code></pre></div>
<p>Here we set <code>gamma</code> to be 0.5 and it is not estimated
along with <code>c</code> or <code>nugget</code>. By default
<code>mcgf</code> provides two optimization functions:
<code>nlminb</code> and <code>optim</code>. Other optimization functions
are also supported as long as their first two arguments are initial
values for the parameters and a function to be minimized respectively
(same as that of <code>optim</code> and <code>nlminb</code>). Also, if
the argument names for upper and lower bounds are not <code>upper</code>
or <code>lower</code>, we can create a simple wrapper to “change”
them.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">library</span>(Rsolnp)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>solnp2 <span class="ot">&lt;-</span> <span class="cf">function</span>(pars, fun, lower, upper, ...) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="fu">solnp</span>(pars, fun, <span class="at">LB =</span> lower, <span class="at">UB =</span> upper, ...)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>}</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>fit_spatial2 <span class="ot">&lt;-</span> <span class="fu">fit_base</span>(</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    wind_mcgf,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;spatial&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">lag =</span> <span class="dv">3</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="at">par_init =</span> <span class="fu">c</span>(<span class="at">nugget =</span> <span class="fl">0.1</span>, <span class="at">c =</span> <span class="fl">0.001</span>),</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="at">par_fixed =</span> <span class="fu">c</span>(<span class="at">gamma =</span> <span class="fl">0.5</span>),</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="at">optim_fn =</span> <span class="st">&quot;other&quot;</span>,</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="at">other_optim_fn =</span> <span class="st">&quot;solnp2&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; Iter: 1 fn: 1.7420    Pars:  0.001326 0.049130</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; Iter: 2 fn: 1.7420    Pars:  0.001326 0.049131</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>fit_spatial2<span class="sc">$</span>fit</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; $pars</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt;           c      nugget </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; 0.001326108 0.049130989 </span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; $convergence</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; $values</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; [1] 2.539093 1.742004 1.742004</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; $lagrange</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt; $hessian</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; [1,] 58426689.3 390846.623</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; [2,]   390846.6   3318.261</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; $ineqx0</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; NULL</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; $nfuneval</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt; [1] 65</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; $outer.iter</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; $elapsed</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt; Time difference of 0.008493185 secs</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; $vscale</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 1</span></span></code></pre></div>
</div>
<div id="pure-temporal-model" class="section level3">
<h3>Pure Temporal Model</h3>
<p>The pure temporal can also be fitted by <code>fit_base</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>fit_temporal <span class="ot">&lt;-</span> <span class="fu">fit_base</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    wind_mcgf,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;temporal&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="at">lag =</span> <span class="dv">3</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="at">par_init =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>fit_temporal<span class="sc">$</span>fit</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; $par</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt;         a     alpha </span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; 0.9774157 0.8053363 </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; $objective</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.0006466064</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; $convergence</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; $iterations</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; [1] 12</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; $evaluations</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; function gradient </span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt;       15       31 </span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; $message</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; [1] &quot;both X-convergence and relative convergence (5)&quot;</span></span></code></pre></div>
<p>Before fitting the fully symmetric model, we need to store the fitted
spatial and temporal models to <code>wind_mcgf</code> using
<code>add_base</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>wind_mcgf <span class="ot">&lt;-</span> <span class="fu">add_base</span>(wind_mcgf,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    <span class="at">fit_s =</span> fit_spatial,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="at">fit_t =</span> fit_temporal,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="at">sep =</span> T</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="separable-model" class="section level3">
<h3>Separable Model</h3>
<p>We can also fit the pure spatial and temporal models all at once by
fitting a separable model:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>fit_sep <span class="ot">&lt;-</span> <span class="fu">fit_base</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>    wind_mcgf,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;sep&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    <span class="at">lag =</span> <span class="dv">3</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    <span class="at">par_init =</span> <span class="fu">c</span>(<span class="at">nugget =</span> <span class="fl">0.1</span>, <span class="at">c =</span> <span class="fl">0.001</span>, <span class="at">a =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    <span class="at">par_fixed =</span> <span class="fu">c</span>(<span class="at">gamma =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>fit_sep<span class="sc">$</span>fit</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; $par</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt;           c      nugget           a       alpha </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; 0.001309516 0.050551635 0.877172554 0.869117694 </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; $objective</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; [1] 2.838544</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; $convergence</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; $iterations</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; [1] 25</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; $evaluations</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; function gradient </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt;       54      121 </span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; $message</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;relative convergence (4)&quot;</span></span></code></pre></div>
<p>Once can also store this model to <code>wind_mcgf</code>, but to be
consistent with <span class="citation">Gneiting, Genton, and Guttorp
(2006)</span>, we will just use the estimates from the pure spatial and
temporal models to estimate the interaction parameter
<code>beta</code>.</p>
</div>
<div id="fully-symmetric-model" class="section level3">
<h3>Fully Symmetric Model</h3>
<p>When holding other parameters constant, the parameter
<code>beta</code> can be estimated by:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>par_sep <span class="ot">&lt;-</span> <span class="fu">c</span>(fit_spatial<span class="sc">$</span>fit<span class="sc">$</span>par, fit_temporal<span class="sc">$</span>fit<span class="sc">$</span>par, <span class="at">gamma =</span> <span class="fl">0.5</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>fit_fs <span class="ot">&lt;-</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="fu">fit_base</span>(</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>        wind_mcgf,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>        <span class="at">model =</span> <span class="st">&quot;fs&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">3</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>        <span class="at">par_init =</span> <span class="fu">c</span>(<span class="at">beta =</span> <span class="dv">0</span>),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>        <span class="at">par_fixed =</span> par_sep</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    )</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>fit_fs<span class="sc">$</span>fit</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; $par</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;     beta </span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; 0.623209 </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; $objective</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; [1] 2.85823</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; $convergence</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; $iterations</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; $evaluations</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; function gradient </span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt;        6        7 </span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co">#&gt; $message</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; [1] &quot;relative convergence (4)&quot;</span></span></code></pre></div>
<p>At this stage, we have fitted the base model, and we will store the
fully symmetric model as the base model and print the base model:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>wind_mcgf <span class="ot">&lt;-</span> <span class="fu">add_base</span>(wind_mcgf, <span class="at">fit_base =</span> fit_fs, <span class="at">old =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">model</span>(wind_mcgf, <span class="at">model =</span> <span class="st">&quot;base&quot;</span>, <span class="at">old =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;                  Model</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; - Time lag: 3 </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; - Scale of time lag: 1 </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; - Forecast horizon: 1 </span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt;             Old - not in use</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; - Base-old model: sep </span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; - Parameters:</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt;           c      nugget       gamma           a       alpha </span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; 0.001326223 0.049124593 0.500000000 0.977415717 0.805336266 </span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; - Fixed parameters:</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt; gamma </span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt;   0.5 </span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; - Parameter estimation method: wls wls </span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; - Optimization function: nlminb nlminb </span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt;                  Base</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a><span class="co">#&gt; - Base model: fs </span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co">#&gt; - Parameters:</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="co">#&gt;        beta           c      nugget           a       alpha       gamma </span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a><span class="co">#&gt; 0.623209028 0.001326223 0.049124593 0.977415717 0.805336266 0.500000000 </span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a><span class="co">#&gt; - Fixed parameters:</span></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a><span class="co">#&gt;           c      nugget           a       alpha       gamma </span></span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a><span class="co">#&gt; 0.001326223 0.049124593 0.977415717 0.805336266 0.500000000 </span></span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a><span class="co">#&gt; - Parameter estimation method: wls </span></span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a><span class="co">#&gt; - Optimization function: nlminb</span></span></code></pre></div>
<p>The <code>old = TRUE</code> in <code>add_base</code> keeps the fitted
pure spatial and temporal models for records, and they are not used for
any further steps. It is recommended to keep the old model not only for
reproducibility, but to keep a history of fitted models.</p>
</div>
<div id="lagrangian-model" class="section level3">
<h3>Lagrangian Model</h3>
<p>We will fit a Lagrangian correlation function to model the westerly
wind:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>fit_lagr <span class="ot">&lt;-</span> <span class="fu">fit_lagr</span>(wind_mcgf,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;lagr_tri&quot;</span>,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>    <span class="at">par_init =</span> <span class="fu">c</span>(<span class="at">v1 =</span> <span class="dv">200</span>, <span class="at">lambda =</span> <span class="fl">0.1</span>),</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    <span class="at">par_fixed =</span> <span class="fu">c</span>(<span class="at">v2 =</span> <span class="dv">0</span>, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>fit_lagr<span class="sc">$</span>fit</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; $par</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt;       lambda           v1 </span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt;   0.05594261 212.31609001 </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; $objective</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; [1] 2.66224</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; $convergence</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; $iterations</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; [1] 18</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; $evaluations</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; function gradient </span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt;       21       54 </span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; $message</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; [1] &quot;relative convergence (4)&quot;</span></span></code></pre></div>
<p>Finally we will store this model to <code>wind_mcgf</code> using
<code>add_lagr</code> and then print the final model:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>wind_mcgf <span class="ot">&lt;-</span> <span class="fu">add_lagr</span>(wind_mcgf, <span class="at">fit_lagr =</span> fit_lagr)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">model</span>(wind_mcgf, <span class="at">old =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt;                  Model</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; - Time lag: 3 </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; - Scale of time lag: 1 </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; - Forecast horizon: 1 </span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;             Old - not in use</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; - Base-old model: sep </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; - Parameters:</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt;           c      nugget       gamma           a       alpha </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; 0.001326223 0.049124593 0.500000000 0.977415717 0.805336266 </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; - Fixed parameters:</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; gamma </span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt;   0.5 </span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; - Parameter estimation method: wls wls </span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; - Optimization function: nlminb nlminb </span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt;                  Base</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; - Base model: fs </span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; - Parameters:</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt;        beta           c      nugget           a       alpha       gamma </span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; 0.623209028 0.001326223 0.049124593 0.977415717 0.805336266 0.500000000 </span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">#&gt; - Fixed parameters:</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a><span class="co">#&gt;           c      nugget           a       alpha       gamma </span></span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a><span class="co">#&gt; 0.001326223 0.049124593 0.977415717 0.805336266 0.500000000 </span></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co">#&gt; - Parameter estimation method: wls </span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a><span class="co">#&gt; - Optimization function: nlminb </span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a><span class="co">#&gt;               Lagrangian</span></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------</span></span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a><span class="co">#&gt; - Lagrangian model: lagr_tri </span></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a><span class="co">#&gt; - Parameters:</span></span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a><span class="co">#&gt;       lambda           v1           v2            k </span></span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a><span class="co">#&gt;   0.05594261 212.31609001   0.00000000   2.00000000 </span></span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a><span class="co">#&gt; - Fixed parameters:</span></span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a><span class="co">#&gt; v2  k </span></span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a><span class="co">#&gt;  0  2 </span></span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a><span class="co">#&gt; - Parameter estimation method: wls </span></span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-53"><a href="#cb18-53" tabindex="-1"></a><span class="co">#&gt; - Optimization function: nlminb</span></span></code></pre></div>
</div>
</div>
<div id="simple-kriging" class="section level2">
<h2>Simple Kriging</h2>
<p>For the test dataset, we can obtain the simple kriging forecasts and
intervals for the empirical model, base model, and general stationary
model using the <code>krige</code> function:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>krige_emp <span class="ot">&lt;-</span> <span class="fu">krige</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>    <span class="at">x =</span> wind_mcgf,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>    <span class="at">newdata =</span> wind_test[, <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;empirical&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="at">interval =</span> <span class="cn">TRUE</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>krige_base <span class="ot">&lt;-</span> <span class="fu">krige</span>(</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    <span class="at">x =</span> wind_mcgf,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>    <span class="at">newdata =</span> wind_test[, <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;base&quot;</span>,</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>    <span class="at">interval =</span> <span class="cn">TRUE</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>)</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>krige_stat <span class="ot">&lt;-</span> <span class="fu">krige</span>(</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>    <span class="at">x =</span> wind_mcgf,</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>    <span class="at">newdata =</span> wind_test[, <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;all&quot;</span>,</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>    <span class="at">interval =</span> <span class="cn">TRUE</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>)</span></code></pre></div>
<p>Next, we can compute the root mean square error (RMSE), mean absolute
error (MAE), and the realized percentage of observations falling outside
the 95% PI (POPI) for these models on the test dataset.</p>
<div id="rmse" class="section level3">
<h3>RMSE</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># RMSE</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>rmse_emp <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">colMeans</span>((wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> krige_emp<span class="sc">$</span>fit)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> T))</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>rmse_base <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">colMeans</span>((wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> krige_base<span class="sc">$</span>fit)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> T))</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>rmse_stat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">colMeans</span>((wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> krige_stat<span class="sc">$</span>fit)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> T))</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    <span class="st">&quot;Empirical&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(rmse_emp),</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    <span class="st">&quot;Base&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(rmse_base),</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="st">&quot;STAT&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(rmse_emp)</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>)</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>rmse</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; Empirical      Base      STAT </span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; 0.4778542 0.4890463 0.4778542</span></span></code></pre></div>
</div>
<div id="mae" class="section level3">
<h3>MAE</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>mae_emp <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">abs</span>(wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> krige_emp<span class="sc">$</span>fit), <span class="at">na.rm =</span> T)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>mae_base <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">abs</span>(wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> krige_base<span class="sc">$</span>fit), <span class="at">na.rm =</span> T)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>mae_stat <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">abs</span>(wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> krige_stat<span class="sc">$</span>fit), <span class="at">na.rm =</span> T)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>    <span class="st">&quot;Empirical&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(mae_emp),</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>    <span class="st">&quot;Base&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(mae_base),</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>    <span class="st">&quot;STAT&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(mae_stat)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>mae</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; Empirical      Base      STAT </span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; 0.3776108 0.3890039 0.3851624</span></span></code></pre></div>
</div>
<div id="popi" class="section level3">
<h3>POPI</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># POPI</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>popi_emp <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">&lt;</span> krige_emp<span class="sc">$</span>lower <span class="sc">|</span> wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">&gt;</span> krige_emp<span class="sc">$</span>upper,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    <span class="at">na.rm =</span> T</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>popi_base <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">&lt;</span> krige_base<span class="sc">$</span>lower <span class="sc">|</span> wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">&gt;</span> krige_base<span class="sc">$</span>upper,</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    <span class="at">na.rm =</span> T</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>popi_stat <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>    wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">&lt;</span> krige_stat<span class="sc">$</span>lower <span class="sc">|</span> wind_test[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">&gt;</span> krige_stat<span class="sc">$</span>upper,</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>    <span class="at">na.rm =</span> T</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>)</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>popi <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>    <span class="st">&quot;Empirical&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(popi_emp),</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>    <span class="st">&quot;Base&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(popi_base),</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>    <span class="st">&quot;STAT&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(popi_stat)</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>)</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>popi</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt;  Empirical       Base       STAT </span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt; 0.06962321 0.06473026 0.06326550</span></span></code></pre></div>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gneiting2002" class="csl-entry">
Gneiting, Tilmann. 2002. <span>“Nonseparable, Stationary Covariance
Functions for Space–Time Data.”</span> <em>Journal of the American
Statistical Association</em> 97 (458): 590–600. <a href="https://doi.org/10.1198/016214502760047113">https://doi.org/10.1198/016214502760047113</a>.
</div>
<div id="ref-Gneiting2006a" class="csl-entry">
Gneiting, Tilmann, Marc G. Genton, and Peter Guttorp. 2006.
<span>“Geostatistical Space-Time Models, Stationarity, Separability and
Full Symmetry.”</span> Department of Statistics, University of
Washington; <a href="https://stat.uw.edu/sites/default/files/files/reports/2005/tr475.pdf" class="uri">https://stat.uw.edu/sites/default/files/files/reports/2005/tr475.pdf</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
